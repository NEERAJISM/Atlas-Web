<div class="container-fluid mt-3">
  <!-- Quick Summary -->

  <div class="row">
    <div class="col col-lg-3">
      <mat-card class="p-2">
        <mat-card-header>
          <div
            mat-card-avatar
            style="background-color: #4caf50"
            class="center-div"
          >
            <i
              class="fas fa-file-invoice text-white"
              style="font-size: 1.3em"
            ></i>
          </div>
          <mat-card-subtitle class="mb-0"
            >Total New orders created</mat-card-subtitle
          >
          <mat-card-title class="mb-0" style="color: #4caf50"
            >37</mat-card-title
          >
        </mat-card-header>
      </mat-card>
    </div>

    <div class="col col-lg-3">
      <mat-card class="p-2">
        <mat-card-header>
          <div
            mat-card-avatar
            style="background-color: #009688"
            class="center-div"
          >
            <i
              class="fas fa-rupee-sign text-white"
              style="font-size: 1.3em"
            ></i>
          </div>
          <mat-card-subtitle class="mb-0"
            >Total cash business</mat-card-subtitle
          >
          <mat-card-title class="mb-0" style="color: #009688"
            >7500.0</mat-card-title
          >
        </mat-card-header>
      </mat-card>
    </div>

    <div class="col col-lg-3">
      <mat-card class="p-2">
        <mat-card-header>
          <div
            mat-card-avatar
            style="background-color: #00bcd4"
            class="center-div"
          >
            <i
              class="fas fa-rupee-sign text-white"
              style="font-size: 1.3em"
            ></i>
          </div>
          <mat-card-subtitle class="mb-0">Payment Received</mat-card-subtitle>
          <mat-card-title class="mb-0" style="color: #00bcd4"
            >5000.0</mat-card-title
          >
        </mat-card-header>
      </mat-card>
    </div>

    <div class="col col-lg-3">
      <mat-card class="p-2">
        <mat-card-header>
          <div
            mat-card-avatar
            style="background-color: #03a9f4"
            class="center-div"
          >
            <i class="fas fa-bell text-white" style="font-size: 1.3em"></i>
          </div>
          <mat-card-subtitle class="mb-0">Pending Payment</mat-card-subtitle>
          <mat-card-title class="mb-0" style="color: #03a9f4"
            >2500.0</mat-card-title
          >
        </mat-card-header>
      </mat-card>
    </div>
  </div>

  <mat-tab-group
    mat-stretch-tabs
    class="mt-4"
    (selectedTabChange)="tabChange($event)"
  >
    <mat-tab>
      <ng-template mat-tab-label>
        <i
          class="fas fa-clipboard-list text-danger mr-2"
          style="font-size: 1.3rem"
        ></i>
        All Orders ({{ all }})
      </ng-template>
    </mat-tab>

    <mat-tab>
      <ng-template mat-tab-label>
        <i class="fas fa-bell mr-2 text-primary" style="font-size: 1.3rem"></i>
        New Orders ({{ new }})
      </ng-template>
    </mat-tab>

    <mat-tab>
      <ng-template mat-tab-label>
        <i class="fas fa-check mr-2 text-success" style="font-size: 1.3rem"></i>
        Accepted ({{ accept }})
      </ng-template>
    </mat-tab>

    <mat-tab>
      <ng-template mat-tab-label>
        <i
          class="fas fa-stopwatch text-warning mr-2"
          style="font-size: 1.3rem"
        ></i>
        In Progress ({{ progress }})
      </ng-template>
    </mat-tab>

    <mat-tab>
      <ng-template mat-tab-label>
        <i class="fas fa-history mr-2" style="font-size: 1.3rem"></i>
        Completed ({{ completed }})
      </ng-template>
    </mat-tab>

    <mat-tab>
      <ng-template mat-tab-label>
        <i class="fas fa-times mr-2 text-danger" style="font-size: 1.3rem"></i>
        Cancelled ({{ canceled }})
      </ng-template>
    </mat-tab>
  </mat-tab-group>

  <div class="row">
    <div class="col">
      <mat-card class="order-card" *ngFor="let order of orders; index as i">
        
        <div class="row" style="padding: 16px; background: #eeeeee">
          <div class="col-lg-2">
            <h5>Date</h5>
            <p>{{ getDate(order.createdTimeUTC) }}</p>
          </div>
          <div class="col-lg-2">
            <h5>Status</h5>
            <b>{{ order.status[order.status.length - 1].status }}</b>
          </div>
          <div class="col-lg-2">
            <h5>Total</h5>
            <p>&#8377; {{ order.total }}</p>
          </div>
          <div class="col-lg-6">
            <h5># Order Id</h5>
            <p>{{ order.vId }}</p>
          </div>
        </div>

        <mat-card-content class="px-4 pb-4">
          <div class="row">
            <div class="col-lg-10">
              <div *ngFor="let item of order.items" class="row mt-4">
                <div>
                  <img class="img-img" [src]="url" />
                </div>
                <div class="col-lg-8 ml-4">
                  <div class="row">
                    <h5>{{ item.name }}</h5>
                  </div>
                  <div class="row mt-2">
                    <h6>
                      <i>{{ item.qty }} x {{ item.unit }}</i>
                    </h6>
                  </div>
                  <div class="row mt-3">
                    <h6 class="text-success">&#8377; {{ item.total }}</h6>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg-2 mt-4">
              <!-- Success -->
              <div
                class="row"
                *ngIf="order.status[order.status.length - 1].status === 'New'"
              >
                <button
                  mat-flat-button
                  class="btn btn-success m-0"
                  style="float: right; width: 100%"
                  (click)="updateOrder(i, 'Accept')"
                >
                  <i class="fas fa-check"></i>
                  &nbsp;Accept Order
                </button>
              </div>
              <div
                class="row"
                *ngIf="
                  order.status[order.status.length - 1].status === 'Accept'
                "
              >
                <button
                  mat-flat-button
                  class="btn btn-success m-0"
                  style="float: right; width: 100%"
                  (click)="updateOrder(i, 'Progress')"
                >
                  <i class="fas fa-check"></i>
                  &nbsp;Mark in Progress
                </button>
              </div>
              <div
                class="row"
                *ngIf="
                  order.status[order.status.length - 1].status === 'Progress'
                "
              >
                <button
                  mat-flat-button
                  class="btn btn-success m-0"
                  style="float: right; width: 100%"
                  (click)="updateOrder(i, 'Complete')"
                >
                  <i class="fas fa-check"></i>
                  &nbsp;Mark as Complete
                </button>
              </div>

              <div
                class="row"
                *ngIf="
                  order.status[order.status.length - 1].status !== 'Complete' &&
                  order.status[order.status.length - 1].status !== 'Cancel'
                "
              >
                <button
                  mat-flat-button
                  class="btn btn-danger mt-2"
                  style="float: right; width: 100%"
                  (click)="updateOrder(i, 'Cancel')"
                >
                  <i class="far fa-times-circle"></i>
                  &nbsp;Cancel Order
                </button>
              </div>
              <div class="row mt-2">
                <button
                  mat-flat-button
                  class="btn btn-warning m-0"
                  style="float: right; width: 100%"
                >
                  <i class="fas fa-question"></i>
                  &nbsp;Need help
                </button>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <div class="row mt-2 mb-4" style="display: flex; justify-content: center">
        <button
          mat-flat-button
          (click)="increaseOrderLimit()"
          class="col-lg-4 py-2 btn btn-secondary"
        >
          <i
            class="fas fa-redo-alt"
            [ngClass]="{
              'fa-spin': orders.length === 0
            }"
          ></i>
          &nbsp;{{
            orders.length === 0 ? "Loading Orders ..." : "Load more orders"
          }}
        </button>
      </div>
    </div>
  </div>
</div>
